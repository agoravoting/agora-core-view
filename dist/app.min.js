function BigInteger(a,b,c){this.arr=new Array,null!=a&&("number"==typeof a?this.fromNumber(a,b,c):null==b&&"string"!=typeof a?this.fromString(a,256):this.fromString(a,b))}function nbi(){return new BigInteger(null)}function am1(a,b,c,d,e,f){for(;--f>=0;){var g=b*this.arr[a++]+c.arr[d]+e;e=Math.floor(g/67108864),c.arr[d++]=67108863&g}return e}function am2(a,b,c,d,e,f){for(var g=32767&b,h=b>>15;--f>=0;){var i=32767&this.arr[a],j=this.arr[a++]>>15,k=h*i+j*g;i=g*i+((32767&k)<<15)+c.arr[d]+(1073741823&e),e=(i>>>30)+(k>>>15)+h*j+(e>>>30),c.arr[d++]=1073741823&i}return e}function am3(a,b,c,d,e,f){for(var g=16383&b,h=b>>14;--f>=0;){var i=16383&this.arr[a],j=this.arr[a++]>>14,k=h*i+j*g;i=g*i+((16383&k)<<14)+c.arr[d]+e,e=(i>>28)+(k>>14)+h*j,c.arr[d++]=268435455&i}return e}function int2char(a){return BI_RM.charAt(a)}function intAt(a,b){var c=BI_RC[a.charCodeAt(b)];return null==c?-1:c}function bnpCopyTo(a){for(var b=this.t-1;b>=0;--b)a.arr[b]=this.arr[b];a.t=this.t,a.s=this.s}function bnpFromInt(a){this.t=1,this.s=0>a?-1:0,a>0?this.arr[0]=a:-1>a?this.arr[0]=a+DV:this.t=0}function nbv(a){var b=nbi();return b.fromInt(a),b}function bnpFromString(a,b){var c;if(16==b)c=4;else if(8==b)c=3;else if(256==b)c=8;else if(2==b)c=1;else if(32==b)c=5;else{if(4!=b)return void this.fromRadix(a,b);c=2}this.t=0,this.s=0;for(var d=a.length,e=!1,f=0;--d>=0;){var g=8==c?255&a[d]:intAt(a,d);0>g?"-"==a.charAt(d)&&(e=!0):(e=!1,0==f?this.arr[this.t++]=g:f+c>this.DB?(this.arr[this.t-1]|=(g&(1<<this.DB-f)-1)<<f,this.arr[this.t++]=g>>this.DB-f):this.arr[this.t-1]|=g<<f,f+=c,f>=this.DB&&(f-=this.DB))}8==c&&0!=(128&a[0])&&(this.s=-1,f>0&&(this.arr[this.t-1]|=(1<<this.DB-f)-1<<f)),this.clamp(),e&&BigInteger.ZERO.subTo(this,this)}function bnpClamp(){for(var a=this.s&this.DM;this.t>0&&this.arr[this.t-1]==a;)--this.t}function bnToString(a){if(this.s<0)return"-"+this.negate().toString(a);var b;if(16==a)b=4;else if(8==a)b=3;else if(2==a)b=1;else if(32==a)b=5;else{if(4!=a)return this.toRadix(a);b=2}var c,d=(1<<b)-1,e=!1,f="",g=this.t,h=this.DB-g*this.DB%b;if(g-->0)for(h<this.DB&&(c=this.arr[g]>>h)>0&&(e=!0,f=int2char(c));g>=0;)b>h?(c=(this.arr[g]&(1<<h)-1)<<b-h,c|=this.arr[--g]>>(h+=this.DB-b)):(c=this.arr[g]>>(h-=b)&d,0>=h&&(h+=this.DB,--g)),c>0&&(e=!0),e&&(f+=int2char(c));return e?f:"0"}function bnNegate(){var a=nbi();return BigInteger.ZERO.subTo(this,a),a}function bnAbs(){return this.s<0?this.negate():this}function bnCompareTo(a){var b=this.s-a.s;if(0!=b)return b;var c=this.t;if(b=c-a.t,0!=b)return b;for(;--c>=0;)if(0!=(b=this.arr[c]-a.arr[c]))return b;return 0}function nbits(a){var b,c=1;return 0!=(b=a>>>16)&&(a=b,c+=16),0!=(b=a>>8)&&(a=b,c+=8),0!=(b=a>>4)&&(a=b,c+=4),0!=(b=a>>2)&&(a=b,c+=2),0!=(b=a>>1)&&(a=b,c+=1),c}function bnBitLength(){return this.t<=0?0:this.DB*(this.t-1)+nbits(this.arr[this.t-1]^this.s&this.DM)}function bnpDLShiftTo(a,b){var c;for(c=this.t-1;c>=0;--c)b.arr[c+a]=this.arr[c];for(c=a-1;c>=0;--c)b.arr[c]=0;b.t=this.t+a,b.s=this.s}function bnpDRShiftTo(a,b){for(var c=a;c<this.t;++c)b.arr[c-a]=this.arr[c];b.t=Math.max(this.t-a,0),b.s=this.s}function bnpLShiftTo(a,b){var c,d=a%this.DB,e=this.DB-d,f=(1<<e)-1,g=Math.floor(a/this.DB),h=this.s<<d&this.DM;for(c=this.t-1;c>=0;--c)b.arr[c+g+1]=this.arr[c]>>e|h,h=(this.arr[c]&f)<<d;for(c=g-1;c>=0;--c)b.arr[c]=0;b.arr[g]=h,b.t=this.t+g+1,b.s=this.s,b.clamp()}function bnpRShiftTo(a,b){b.s=this.s;var c=Math.floor(a/this.DB);if(c>=this.t)return void(b.t=0);var d=a%this.DB,e=this.DB-d,f=(1<<d)-1;b.arr[0]=this.arr[c]>>d;for(var g=c+1;g<this.t;++g)b.arr[g-c-1]|=(this.arr[g]&f)<<e,b.arr[g-c]=this.arr[g]>>d;d>0&&(b.arr[this.t-c-1]|=(this.s&f)<<e),b.t=this.t-c,b.clamp()}function bnpSubTo(a,b){for(var c=0,d=0,e=Math.min(a.t,this.t);e>c;)d+=this.arr[c]-a.arr[c],b.arr[c++]=d&this.DM,d>>=this.DB;if(a.t<this.t){for(d-=a.s;c<this.t;)d+=this.arr[c],b.arr[c++]=d&this.DM,d>>=this.DB;d+=this.s}else{for(d+=this.s;c<a.t;)d-=a.arr[c],b.arr[c++]=d&this.DM,d>>=this.DB;d-=a.s}b.s=0>d?-1:0,-1>d?b.arr[c++]=this.DV+d:d>0&&(b.arr[c++]=d),b.t=c,b.clamp()}function bnpMultiplyTo(a,b){var c=this.abs(),d=a.abs(),e=c.t;for(b.t=e+d.t;--e>=0;)b.arr[e]=0;for(e=0;e<d.t;++e)b.arr[e+c.t]=c.am(0,d.arr[e],b,e,0,c.t);b.s=0,b.clamp(),this.s!=a.s&&BigInteger.ZERO.subTo(b,b)}function bnpSquareTo(a){for(var b=this.abs(),c=a.t=2*b.t;--c>=0;)a.arr[c]=0;for(c=0;c<b.t-1;++c){var d=b.am(c,b.arr[c],a,2*c,0,1);(a.arr[c+b.t]+=b.am(c+1,2*b.arr[c],a,2*c+1,d,b.t-c-1))>=b.DV&&(a.arr[c+b.t]-=b.DV,a.arr[c+b.t+1]=1)}a.t>0&&(a.arr[a.t-1]+=b.am(c,b.arr[c],a,2*c,0,1)),a.s=0,a.clamp()}function bnpDivRemTo(a,b,c){var d=a.abs();if(!(d.t<=0)){var e=this.abs();if(e.t<d.t)return null!=b&&b.fromInt(0),void(null!=c&&this.copyTo(c));null==c&&(c=nbi());var f=nbi(),g=this.s,h=a.s,i=this.DB-nbits(d.arr[d.t-1]);i>0?(d.lShiftTo(i,f),e.lShiftTo(i,c)):(d.copyTo(f),e.copyTo(c));var j=f.t,k=f.arr[j-1];if(0!=k){var l=k*(1<<this.F1)+(j>1?f.arr[j-2]>>this.F2:0),m=this.FV/l,n=(1<<this.F1)/l,o=1<<this.F2,p=c.t,q=p-j,r=null==b?nbi():b;for(f.dlShiftTo(q,r),c.compareTo(r)>=0&&(c.arr[c.t++]=1,c.subTo(r,c)),BigInteger.ONE.dlShiftTo(j,r),r.subTo(f,f);f.t<j;)f.arr[f.t++]=0;for(;--q>=0;){var s=c.arr[--p]==k?this.DM:Math.floor(c.arr[p]*m+(c.arr[p-1]+o)*n);if((c.arr[p]+=f.am(0,s,c,q,0,j))<s)for(f.dlShiftTo(q,r),c.subTo(r,c);c.arr[p]<--s;)c.subTo(r,c)}null!=b&&(c.drShiftTo(j,b),g!=h&&BigInteger.ZERO.subTo(b,b)),c.t=j,c.clamp(),i>0&&c.rShiftTo(i,c),0>g&&BigInteger.ZERO.subTo(c,c)}}}function bnMod(a){var b=nbi();return this.abs().divRemTo(a,null,b),this.s<0&&b.compareTo(BigInteger.ZERO)>0&&a.subTo(b,b),b}function Classic(a){this.m=a}function cConvert(a){return a.s<0||a.compareTo(this.m)>=0?a.mod(this.m):a}function cRevert(a){return a}function cReduce(a){a.divRemTo(this.m,null,a)}function cMulTo(a,b,c){a.multiplyTo(b,c),this.reduce(c)}function cSqrTo(a,b){a.squareTo(b),this.reduce(b)}function bnpInvDigit(){if(this.t<1)return 0;var a=this.arr[0];if(0==(1&a))return 0;var b=3&a;return b=b*(2-(15&a)*b)&15,b=b*(2-(255&a)*b)&255,b=b*(2-((65535&a)*b&65535))&65535,b=b*(2-a*b%this.DV)%this.DV,b>0?this.DV-b:-b}function Montgomery(a){this.m=a,this.mp=a.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<a.DB-15)-1,this.mt2=2*a.t}function montConvert(a){var b=nbi();return a.abs().dlShiftTo(this.m.t,b),b.divRemTo(this.m,null,b),a.s<0&&b.compareTo(BigInteger.ZERO)>0&&this.m.subTo(b,b),b}function montRevert(a){var b=nbi();return a.copyTo(b),this.reduce(b),b}function montReduce(a){for(;a.t<=this.mt2;)a.arr[a.t++]=0;for(var b=0;b<this.m.t;++b){var c=32767&a.arr[b],d=c*this.mpl+((c*this.mph+(a.arr[b]>>15)*this.mpl&this.um)<<15)&a.DM;for(c=b+this.m.t,a.arr[c]+=this.m.am(0,d,a,b,0,this.m.t);a.arr[c]>=a.DV;)a.arr[c]-=a.DV,a.arr[++c]++}a.clamp(),a.drShiftTo(this.m.t,a),a.compareTo(this.m)>=0&&a.subTo(this.m,a)}function montSqrTo(a,b){a.squareTo(b),this.reduce(b)}function montMulTo(a,b,c){a.multiplyTo(b,c),this.reduce(c)}function bnpIsEven(){return 0==(this.t>0?1&this.arr[0]:this.s)}function bnpExp(a,b){if(a>4294967295||1>a)return BigInteger.ONE;var c=nbi(),d=nbi(),e=b.convert(this),f=nbits(a)-1;for(e.copyTo(c);--f>=0;)if(b.sqrTo(c,d),(a&1<<f)>0)b.mulTo(d,e,c);else{var g=c;c=d,d=g}return b.revert(c)}function bnModPowInt(a,b){var c;return c=256>a||b.isEven()?new Classic(b):new Montgomery(b),this.exp(a,c)}function bnClone(){var a=nbi();return this.copyTo(a),a}function bnIntValue(){if(this.s<0){if(1==this.t)return this.arr[0]-this.DV;if(0==this.t)return-1}else{if(1==this.t)return this.arr[0];if(0==this.t)return 0}return(this.arr[1]&(1<<32-this.DB)-1)<<this.DB|this.arr[0]}function bnByteValue(){return 0==this.t?this.s:this.arr[0]<<24>>24}function bnShortValue(){return 0==this.t?this.s:this.arr[0]<<16>>16}function bnpChunkSize(a){return Math.floor(Math.LN2*this.DB/Math.log(a))}function bnSigNum(){return this.s<0?-1:this.t<=0||1==this.t&&this.arr[0]<=0?0:1}function bnpToRadix(a){if(null==a&&(a=10),0==this.signum()||2>a||a>36)return"0";var b=this.chunkSize(a),c=Math.pow(a,b),d=nbv(c),e=nbi(),f=nbi(),g="";for(this.divRemTo(d,e,f);e.signum()>0;)g=(c+f.intValue()).toString(a).substr(1)+g,e.divRemTo(d,e,f);return f.intValue().toString(a)+g}function bnpFromRadix(a,b){this.fromInt(0),null==b&&(b=10);for(var c=this.chunkSize(b),d=Math.pow(b,c),e=!1,f=0,g=0,h=0;h<a.length;++h){var i=intAt(a,h);0>i?"-"==a.charAt(h)&&0==this.signum()&&(e=!0):(g=b*g+i,++f>=c&&(this.dMultiply(d),this.dAddOffset(g,0),f=0,g=0))}f>0&&(this.dMultiply(Math.pow(b,f)),this.dAddOffset(g,0)),e&&BigInteger.ZERO.subTo(this,this)}function bnpFromNumber(a,b,c){if("number"==typeof b)if(2>a)this.fromInt(1);else for(this.fromNumber(a,c),this.testBit(a-1)||this.bitwiseTo(BigInteger.ONE.shiftLeft(a-1),op_or,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(b);)this.dAddOffset(2,0),this.bitLength()>a&&this.subTo(BigInteger.ONE.shiftLeft(a-1),this);else{var d=new Array,e=7&a;d.length=(a>>3)+1,b.nextBytes(d),e>0?d.arr[0]&=(1<<e)-1:d.arr[0]=0,this.fromString(d,256)}}function bnToByteArray(){var a=this.t,b=new Array;b.arr[0]=this.s;var c,d=this.DB-a*this.DB%8,e=0;if(a-->0)for(d<this.DB&&(c=this.arr[a]>>d)!=(this.s&this.DM)>>d&&(b.arr[e++]=c|this.s<<this.DB-d);a>=0;)8>d?(c=(this.arr[a]&(1<<d)-1)<<8-d,c|=this.arr[--a]>>(d+=this.DB-8)):(c=this.arr[a]>>(d-=8)&255,0>=d&&(d+=this.DB,--a)),0!=(128&c)&&(c|=-256),0==e&&(128&this.s)!=(128&c)&&++e,(e>0||c!=this.s)&&(b.arr[e++]=c);return b}function bnEquals(a){return 0==this.compareTo(a)}function bnMin(a){return this.compareTo(a)<0?this:a}function bnMax(a){return this.compareTo(a)>0?this:a}function bnpBitwiseTo(a,b,c){var d,e,f=Math.min(a.t,this.t);for(d=0;f>d;++d)c.arr[d]=b(this.arr[d],a.arr[d]);if(a.t<this.t){for(e=a.s&this.DM,d=f;d<this.t;++d)c.arr[d]=b(this.arr[d],e);c.t=this.t}else{for(e=this.s&this.DM,d=f;d<a.t;++d)c.arr[d]=b(e,a.arr[d]);c.t=a.t}c.s=b(this.s,a.s),c.clamp()}function op_and(a,b){return a&b}function bnAnd(a){var b=nbi();return this.bitwiseTo(a,op_and,b),b}function op_or(a,b){return a|b}function bnOr(a){var b=nbi();return this.bitwiseTo(a,op_or,b),b}function op_xor(a,b){return a^b}function bnXor(a){var b=nbi();return this.bitwiseTo(a,op_xor,b),b}function op_andnot(a,b){return a&~b}function bnAndNot(a){var b=nbi();return this.bitwiseTo(a,op_andnot,b),b}function bnNot(){for(var a=nbi(),b=0;b<this.t;++b)a.arr[b]=this.DM&~this.arr[b];return a.t=this.t,a.s=~this.s,a}function bnShiftLeft(a){var b=nbi();return 0>a?this.rShiftTo(-a,b):this.lShiftTo(a,b),b}function bnShiftRight(a){var b=nbi();return 0>a?this.lShiftTo(-a,b):this.rShiftTo(a,b),b}function lbit(a){if(0==a)return-1;var b=0;return 0==(65535&a)&&(a>>=16,b+=16),0==(255&a)&&(a>>=8,b+=8),0==(15&a)&&(a>>=4,b+=4),0==(3&a)&&(a>>=2,b+=2),0==(1&a)&&++b,b}function bnGetLowestSetBit(){for(var a=0;a<this.t;++a)if(0!=this.arr[a])return a*this.DB+lbit(this.arr[a]);return this.s<0?this.t*this.DB:-1}function cbit(a){for(var b=0;0!=a;)a&=a-1,++b;return b}function bnBitCount(){for(var a=0,b=this.s&this.DM,c=0;c<this.t;++c)a+=cbit(this.arr[c]^b);return a}function bnTestBit(a){var b=Math.floor(a/this.DB);return b>=this.t?0!=this.s:0!=(this.arr[b]&1<<a%this.DB)}function bnpChangeBit(a,b){var c=BigInteger.ONE.shiftLeft(a);return this.bitwiseTo(c,b,c),c}function bnSetBit(a){return this.changeBit(a,op_or)}function bnClearBit(a){return this.changeBit(a,op_andnot)}function bnFlipBit(a){return this.changeBit(a,op_xor)}function bnpAddTo(a,b){for(var c=0,d=0,e=Math.min(a.t,this.t);e>c;)d+=this.arr[c]+a.arr[c],b.arr[c++]=d&this.DM,d>>=this.DB;if(a.t<this.t){for(d+=a.s;c<this.t;)d+=this.arr[c],b.arr[c++]=d&this.DM,d>>=this.DB;d+=this.s}else{for(d+=this.s;c<a.t;)d+=a.arr[c],b.arr[c++]=d&this.DM,d>>=this.DB;d+=a.s}b.s=0>d?-1:0,d>0?b.arr[c++]=d:-1>d&&(b.arr[c++]=this.DV+d),b.t=c,b.clamp()}function bnAdd(a){var b=nbi();return this.addTo(a,b),b}function bnSubtract(a){var b=nbi();return this.subTo(a,b),b}function bnMultiply(a){var b=nbi();return this.multiplyTo(a,b),b}function bnDivide(a){var b=nbi();return this.divRemTo(a,b,null),b}function bnRemainder(a){var b=nbi();return this.divRemTo(a,null,b),b}function bnDivideAndRemainder(a){var b=nbi(),c=nbi();return this.divRemTo(a,b,c),new Array(b,c)}function bnpDMultiply(a){this.arr[this.t]=this.am(0,a-1,this,0,0,this.t),++this.t,this.clamp()}function bnpDAddOffset(a,b){if(0!=a){for(;this.t<=b;)this.arr[this.t++]=0;for(this.arr[b]+=a;this.arr[b]>=this.DV;)this.arr[b]-=this.DV,++b>=this.t&&(this.arr[this.t++]=0),++this.arr[b]}}function NullExp(){}function nNop(a){return a}function nMulTo(a,b,c){a.multiplyTo(b,c)}function nSqrTo(a,b){a.squareTo(b)}function bnPow(a){return this.exp(a,new NullExp)}function bnpMultiplyLowerTo(a,b,c){var d=Math.min(this.t+a.t,b);for(c.s=0,c.t=d;d>0;)c.arr[--d]=0;var e;for(e=c.t-this.t;e>d;++d)c.arr[d+this.t]=this.am(0,a.arr[d],c,d,0,this.t);for(e=Math.min(a.t,b);e>d;++d)this.am(0,a.arr[d],c,d,0,b-d);c.clamp()}function bnpMultiplyUpperTo(a,b,c){--b;var d=c.t=this.t+a.t-b;for(c.s=0;--d>=0;)c.arr[d]=0;for(d=Math.max(b-this.t,0);d<a.t;++d)c.arr[this.t+d-b]=this.am(b-d,a.arr[d],c,0,0,this.t+d-b);c.clamp(),c.drShiftTo(1,c)}function Barrett(a){this.r2=nbi(),this.q3=nbi(),BigInteger.ONE.dlShiftTo(2*a.t,this.r2),this.mu=this.r2.divide(a),this.m=a}function barrettConvert(a){if(a.s<0||a.t>2*this.m.t)return a.mod(this.m);if(a.compareTo(this.m)<0)return a;var b=nbi();return a.copyTo(b),this.reduce(b),b}function barrettRevert(a){return a}function barrettReduce(a){for(a.drShiftTo(this.m.t-1,this.r2),a.t>this.m.t+1&&(a.t=this.m.t+1,a.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);a.compareTo(this.r2)<0;)a.dAddOffset(1,this.m.t+1);for(a.subTo(this.r2,a);a.compareTo(this.m)>=0;)a.subTo(this.m,a)}function barrettSqrTo(a,b){a.squareTo(b),this.reduce(b)}function barrettMulTo(a,b,c){a.multiplyTo(b,c),this.reduce(c)}function bnModPow(a,b){var c,d,e=a.bitLength(),f=nbv(1);if(0>=e)return f;c=18>e?1:48>e?3:144>e?4:768>e?5:6,d=8>e?new Classic(b):b.isEven()?new Barrett(b):new Montgomery(b);var g=new Array,h=3,i=c-1,j=(1<<c)-1;if(g[1]=d.convert(this),c>1){var k=nbi();for(d.sqrTo(g[1],k);j>=h;)g[h]=nbi(),d.mulTo(k,g[h-2],g[h]),h+=2}var l,m,n=a.t-1,o=!0,p=nbi();for(e=nbits(a.arr[n])-1;n>=0;){for(e>=i?l=a.arr[n]>>e-i&j:(l=(a.arr[n]&(1<<e+1)-1)<<i-e,n>0&&(l|=a.arr[n-1]>>this.DB+e-i)),h=c;0==(1&l);)l>>=1,--h;if((e-=h)<0&&(e+=this.DB,--n),o)g[l].copyTo(f),o=!1;else{for(;h>1;)d.sqrTo(f,p),d.sqrTo(p,f),h-=2;h>0?d.sqrTo(f,p):(m=f,f=p,p=m),d.mulTo(p,g[l],f)}for(;n>=0&&0==(a.arr[n]&1<<e);)d.sqrTo(f,p),m=f,f=p,p=m,--e<0&&(e=this.DB-1,--n)}return d.revert(f)}function bnGCD(a){var b=this.s<0?this.negate():this.clone(),c=a.s<0?a.negate():a.clone();if(b.compareTo(c)<0){var d=b;b=c,c=d}var e=b.getLowestSetBit(),f=c.getLowestSetBit();if(0>f)return b;for(f>e&&(f=e),f>0&&(b.rShiftTo(f,b),c.rShiftTo(f,c));b.signum()>0;)(e=b.getLowestSetBit())>0&&b.rShiftTo(e,b),(e=c.getLowestSetBit())>0&&c.rShiftTo(e,c),b.compareTo(c)>=0?(b.subTo(c,b),b.rShiftTo(1,b)):(c.subTo(b,c),c.rShiftTo(1,c));return f>0&&c.lShiftTo(f,c),c}function bnpModInt(a){if(0>=a)return 0;var b=this.DV%a,c=this.s<0?a-1:0;if(this.t>0)if(0==b)c=this.arr[0]%a;else for(var d=this.t-1;d>=0;--d)c=(b*c+this.arr[d])%a;return c}function bnModInverse(a){var b=a.isEven();if(this.isEven()&&b||0==a.signum())return BigInteger.ZERO;for(var c=a.clone(),d=this.clone(),e=nbv(1),f=nbv(0),g=nbv(0),h=nbv(1);0!=c.signum();){for(;c.isEven();)c.rShiftTo(1,c),b?(e.isEven()&&f.isEven()||(e.addTo(this,e),f.subTo(a,f)),e.rShiftTo(1,e)):f.isEven()||f.subTo(a,f),f.rShiftTo(1,f);for(;d.isEven();)d.rShiftTo(1,d),b?(g.isEven()&&h.isEven()||(g.addTo(this,g),h.subTo(a,h)),g.rShiftTo(1,g)):h.isEven()||h.subTo(a,h),h.rShiftTo(1,h);c.compareTo(d)>=0?(c.subTo(d,c),b&&e.subTo(g,e),f.subTo(h,f)):(d.subTo(c,d),b&&g.subTo(e,g),h.subTo(f,h))}return 0!=d.compareTo(BigInteger.ONE)?BigInteger.ZERO:h.compareTo(a)>=0?h.subtract(a):h.signum()<0?(h.addTo(a,h),h.signum()<0?h.add(a):h):h}function bnIsProbablePrime(a){var b,c=this.abs();if(1==c.t&&c.arr[0]<=lowprimes[lowprimes.length-1]){for(b=0;b<lowprimes.length;++b)if(c.arr[0]==lowprimes[b])return!0;return!1}if(c.isEven())return!1;for(b=1;b<lowprimes.length;){for(var d=lowprimes[b],e=b+1;e<lowprimes.length&&lplim>d;)d*=lowprimes[e++];for(d=c.modInt(d);e>b;)if(d%lowprimes[b++]==0)return!1}return c.millerRabin(a)}function bnpMillerRabin(a){var b=this.subtract(BigInteger.ONE),c=b.getLowestSetBit();if(0>=c)return!1;var d=b.shiftRight(c);a=a+1>>1,a>lowprimes.length&&(a=lowprimes.length);for(var e=nbi(),f=0;a>f;++f){e.fromInt(lowprimes[f]);var g=e.modPow(d,this);if(0!=g.compareTo(BigInteger.ONE)&&0!=g.compareTo(b)){for(var h=1;h++<c&&0!=g.compareTo(b);)if(g=g.modPowInt(2,this),0==g.compareTo(BigInteger.ONE))return!1;if(0!=g.compareTo(b))return!1}}return!0}function hex_sha1(a){return binb2hex(core_sha1(str2binb(a),a.length*chrsz))}function b64_sha1(a){return binb2b64(core_sha1(str2binb(a),a.length*chrsz))}function str_sha1(a){return binb2str(core_sha1(str2binb(a),a.length*chrsz))}function hex_hmac_sha1(a,b){return binb2hex(core_hmac_sha1(a,b))}function b64_hmac_sha1(a,b){return binb2b64(core_hmac_sha1(a,b))}function str_hmac_sha1(a,b){return binb2str(core_hmac_sha1(a,b))}function sha1_vm_test(){return"a9993e364706816aba3e25717850c26c9cd0d89d"==hex_sha1("abc")}function core_sha1(a,b){a[b>>5]|=128<<24-b%32,a[(b+64>>9<<4)+15]=b;for(var c=Array(80),d=1732584193,e=-271733879,f=-1732584194,g=271733878,h=-1009589776,i=0;i<a.length;i+=16){for(var j=d,k=e,l=f,m=g,n=h,o=0;80>o;o++){c[o]=16>o?a[i+o]:rol(c[o-3]^c[o-8]^c[o-14]^c[o-16],1);var p=safe_add(safe_add(rol(d,5),sha1_ft(o,e,f,g)),safe_add(safe_add(h,c[o]),sha1_kt(o)));h=g,g=f,f=rol(e,30),e=d,d=p}d=safe_add(d,j),e=safe_add(e,k),f=safe_add(f,l),g=safe_add(g,m),h=safe_add(h,n)}return Array(d,e,f,g,h)}function sha1_ft(a,b,c,d){return 20>a?b&c|~b&d:40>a?b^c^d:60>a?b&c|b&d|c&d:b^c^d}function sha1_kt(a){return 20>a?1518500249:40>a?1859775393:60>a?-1894007588:-899497514}function core_hmac_sha1(a,b){var c=str2binb(a);c.length>16&&(c=core_sha1(c,a.length*chrsz));for(var d=Array(16),e=Array(16),f=0;16>f;f++)d[f]=909522486^c[f],e[f]=1549556828^c[f];var g=core_sha1(d.concat(str2binb(b)),512+b.length*chrsz);return core_sha1(e.concat(g),672)}function safe_add(a,b){var c=(65535&a)+(65535&b),d=(a>>16)+(b>>16)+(c>>16);return d<<16|65535&c}function rol(a,b){return a<<b|a>>>32-b}function str2binb(a){for(var b=Array(),c=(1<<chrsz)-1,d=0;d<a.length*chrsz;d+=chrsz)b[d>>5]|=(a.charCodeAt(d/chrsz)&c)<<32-chrsz-d%32;return b}function binb2str(a){for(var b="",c=(1<<chrsz)-1,d=0;d<32*a.length;d+=chrsz)b+=String.fromCharCode(a[d>>5]>>>32-chrsz-d%32&c);return b}function binb2hex(a){for(var b=hexcase?"0123456789ABCDEF":"0123456789abcdef",c="",d=0;d<4*a.length;d++)c+=b.charAt(a[d>>2]>>8*(3-d%4)+4&15)+b.charAt(a[d>>2]>>8*(3-d%4)&15);return c}function binb2b64(a){for(var b="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",c="",d=0;d<4*a.length;d+=3)for(var e=(a[d>>2]>>8*(3-d%4)&255)<<16|(a[d+1>>2]>>8*(3-(d+1)%4)&255)<<8|a[d+2>>2]>>8*(3-(d+2)%4)&255,f=0;4>f;f++)c+=8*d+6*f>32*a.length?b64pad:b.charAt(e>>6*(3-f)&63);return c}function safe_add(a,b){var c=(65535&a)+(65535&b),d=(a>>16)+(b>>16)+(c>>16);return d<<16|65535&c}function S(a,b){return a>>>b|a<<32-b}function R(a,b){return a>>>b}function Ch(a,b,c){return a&b^~a&c}function Maj(a,b,c){return a&b^a&c^b&c}function Sigma0256(a){return S(a,2)^S(a,13)^S(a,22)}function Sigma1256(a){return S(a,6)^S(a,11)^S(a,25)}function Gamma0256(a){return S(a,7)^S(a,18)^R(a,3)}function Gamma1256(a){return S(a,17)^S(a,19)^R(a,10)}function Sigma0512(a){return S(a,28)^S(a,34)^S(a,39)}function Sigma1512(a){return S(a,14)^S(a,18)^S(a,41)}function Gamma0512(a){return S(a,1)^S(a,8)^R(a,7)}function Gamma1512(a){return S(a,19)^S(a,61)^R(a,6)}function core_sha256(a,b){var c,d,e,f,g,h,i,j,k,l,m,n,o=new Array(1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298),p=new Array(1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225),q=new Array(64);a[b>>5]|=128<<24-b%32,a[(b+64>>9<<4)+15]=b;for(var k=0;k<a.length;k+=16){c=p[0],d=p[1],e=p[2],f=p[3],g=p[4],h=p[5],i=p[6],j=p[7];for(var l=0;64>l;l++)q[l]=16>l?a[l+k]:safe_add(safe_add(safe_add(Gamma1256(q[l-2]),q[l-7]),Gamma0256(q[l-15])),q[l-16]),m=safe_add(safe_add(safe_add(safe_add(j,Sigma1256(g)),Ch(g,h,i)),o[l]),q[l]),n=safe_add(Sigma0256(c),Maj(c,d,e)),j=i,i=h,h=g,g=safe_add(f,m),f=e,e=d,d=c,c=safe_add(m,n);p[0]=safe_add(c,p[0]),p[1]=safe_add(d,p[1]),p[2]=safe_add(e,p[2]),p[3]=safe_add(f,p[3]),p[4]=safe_add(g,p[4]),p[5]=safe_add(h,p[5]),p[6]=safe_add(i,p[6]),p[7]=safe_add(j,p[7])}return p}function core_sha512(){new Array(0x428a2f98d728b000,0x7137449123ef6400,0xb5c0fbcfec4d3800,0xe9b5dba58189d800,413170340833845e4,0x59f111f1b605d000,0x923f82a4af195000,0xab1c5ed5da6d8000,0xd807aa98a3030000,0x12835b0145707000,0x243185be4ee4b200,0x550c7dc3d5ffb400,0x72be5d74f27b8800,0x80deb1fe3b169800,0x9bdc06a725c71000,0xc19bf174cf692800,0xe49b69c19ef14800,0xefbe4786384f2800,0xfc19dc68b8cd580,0x240ca1cc77ac9c00,0x2de92c6f592b0200,0x4a7484aa6ea6e400,0x5cb0a9dcbd41fc00,0x76f988da83115400,0x983e5152ee66e000,0xa831c66d2db43000,0xb00327c898fb2000,0xbf597fc7beef1000,0xc6e00bf33da89000,0xd5a79147930aa800,0x6ca6351e0038280,0x142929670a0e6e00,0x27b70a8546d23000,0x2e1b21385c26ca00,0x4d2c6dfc5ac42c00,0x53380d139d95b400,0x650a73548baf6400,0x766a0abb3c77b400,935025697698701e4,0x92722c8514823800,0xa2bfe8a14cf10000,0xa81a664bbc423000,0xc24b8b70d0f89800,0xc76c51a30654c000,0xd192e819d6ef5000,0xd69906245565a800,0xf40e358557712000,0x106aa07032bbd200,0x19a4c116b8d2d100,0x1e376c085141ab00,0x2748774cdf8eec00,0x34b0bcb5e19b4800,0x391c0cb3c5c95a00,0x4ed8aa4ae3418c00,0x5b9cca4f7763e400,0x682e6ff3d6b2b800,0x748f82ee5defb400,0x78a5636f43173000,0x84c87814a1f0a800,0x8cc702081a643800,0x90befffa23632000,0xa4506cebde82c000,0xbef9a3f7b2c67800,0xc67178f2e3725000,0xca273eceea266000,0xd186b8c721c0c000,0xeada7dd6cde0e800,0xf57d4f7fee6ed000,0x6f067aa72176fc0,0xa637dc5a2c89880,0x113f9804bef90e00,0x1b710b35131c4700,0x28db77f523047e00,0x32caab7b40c72400,0x3c9ebe0a15c9be00,0x431d67c49c100c00,0x4cc5d4becb3e4400,0x597f299cfc658000,0x5fcb6fab3ad6fc00,0x6c44198c4a475800),new Array(0x6a09e667f3bcc800,0xbb67ae8584caa800,0x3c6ef372fe94f800,0xa54ff53a5f1d3800,0x510e527fade68400,0x9b05688c2b3e7000,0x1f83d9abfb41bd00,0x5be0cd19137e2000),new Array(80)}function str2binb(a){for(var b=Array(),c=(1<<chrsz)-1,d=0;d<a.length*chrsz;d+=chrsz)b[d>>5]|=(a.charCodeAt(d/chrsz)&c)<<24-d%32;return b}function binb2str(a){for(var b="",c=(1<<chrsz)-1,d=0;d<32*a.length;d+=chrsz)b+=String.fromCharCode(a[d>>5]>>>24-d%32&c);return b}function binb2hex(a){for(var b=hexcase?"0123456789ABCDEF":"0123456789abcdef",c="",d=0;d<4*a.length;d++)c+=b.charAt(a[d>>2]>>8*(3-d%4)+4&15)+b.charAt(a[d>>2]>>8*(3-d%4)&15);return c}function binb2b64(a){for(var b="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",c="",d=0;d<4*a.length;d+=3)for(var e=(a[d>>2]>>8*(3-d%4)&255)<<16|(a[d+1>>2]>>8*(3-(d+1)%4)&255)<<8|a[d+2>>2]>>8*(3-(d+2)%4)&255,f=0;4>f;f++)c+=8*d+6*f>32*a.length?b64pad:b.charAt(e>>6*(3-f)&63);return c}function hex_sha256(a){return binb2hex(core_sha256(str2binb(a),a.length*chrsz))}function b64_sha256(a){return binb2b64(core_sha256(str2binb(a),a.length*chrsz))}function str_sha256(a){return binb2str(core_sha256(str2binb(a),a.length*chrsz))}function q(a){throw a}function y(a,b,c){4!==b.length&&q(new sjcl.exception.invalid("invalid aes block size"));var d=a.a[c],e=b[0]^d[0],f=b[c?3:1]^d[1],g=b[2]^d[2];b=b[c?1:3]^d[3];var h,i,j,k,l=d.length/4-2,m=4,n=[0,0,0,0];h=a.j[c],a=h[0];var o=h[1],p=h[2],r=h[3],s=h[4];for(k=0;l>k;k++)h=a[e>>>24]^o[f>>16&255]^p[g>>8&255]^r[255&b]^d[m],i=a[f>>>24]^o[g>>16&255]^p[b>>8&255]^r[255&e]^d[m+1],j=a[g>>>24]^o[b>>16&255]^p[e>>8&255]^r[255&f]^d[m+2],b=a[b>>>24]^o[e>>16&255]^p[f>>8&255]^r[255&g]^d[m+3],m+=4,e=h,f=i,g=j;for(k=0;4>k;k++)n[c?3&-k:k]=s[e>>>24]<<24^s[f>>16&255]<<16^s[g>>8&255]<<8^s[255&b]^d[m++],h=e,e=f,f=g,g=b,b=h;return n}function z(a,b){var c,d,e,f=b.slice(0),g=a.q,h=a.a,i=g[0],j=g[1],k=g[2],l=g[3],m=g[4],n=g[5],o=g[6],p=g[7];for(c=0;64>c;c++)16>c?d=f[c]:(d=f[c+1&15],e=f[c+14&15],d=f[15&c]=(d>>>7^d>>>18^d>>>3^d<<25^d<<14)+(e>>>17^e>>>19^e>>>10^e<<15^e<<13)+f[15&c]+f[c+9&15]|0),d=d+p+(m>>>6^m>>>11^m>>>25^m<<26^m<<21^m<<7)+(o^m&(n^o))+h[c],p=o,o=n,n=m,m=l+d|0,l=k,k=j,j=i,i=d+(j&k^l&(j^k))+(j>>>2^j>>>13^j>>>22^j<<30^j<<19^j<<10)|0;g[0]=g[0]+i|0,g[1]=g[1]+j|0,g[2]=g[2]+k|0,g[3]=g[3]+l|0,g[4]=g[4]+m|0,g[5]=g[5]+n|0,g[6]=g[6]+o|0,g[7]=g[7]+p|0}function C(a,b){var c,d=sjcl.random.z[a],e=[];for(c in d)d.hasOwnProperty(c)&&e.push(d[c]);for(c=0;c<e.length;c++)e[c](b)}function A(a){a.a=B(a).concat(B(a)),a.A=new sjcl.cipher.aes(a.a)}function B(a){for(var b=0;4>b&&(a.e[b]=a.e[b]+1|0,!a.e[b]);b++);return a.A.encrypt(a.e)}angular.module("avCrypto",[]),angular.module("avCrypto").service("EncryptAnswerService",function(){function a(a){var b=a,c=ElGamal.PublicKey.fromJSONObject(b);return{encryptAnswer:function(a){var b=new ElGamal.Plaintext(BigInt.fromInt(a),c,!0),d=Random.getRandomInteger(c.q),e=ElGamal.encrypt(c,b,d),f=b.proveKnowledge(e.alpha,d,ElGamal.fiatshamir_dlog_challenge_generator),g=e.toJSONObject(),h={alpha:g.alpha,beta:g.beta,commitment:f.commitment,response:f.response,challenge:f.challenge};return h},getPublicKey:function(){return a},verifyPlaintextProof:function(a){var b=new ElGamal.Ciphertext(BigInt.fromInt(a.alpha),BigInt.fromInt(a.beta),c),d=new ElGamal.DLogProof(a.commitment,a.challenge,a.response);return b.verifyPlaintextProof(d,ElGamal.fiatshamir_dlog_challenge_generator)}}}return{init:function(b){return a(b)},ElGamal:ElGamal,BigInt:BigInt}}),angular.module("avCrypto").service("HmacService",function(){function a(a,b){var d=c.codec.utf8String.toBits(a),e=new c.misc.hmac(d,c.hash.sha256).mac(b);return c.codec.hex.fromBits(e)}function b(a,b){for(var c=a.length,d=b.length,e=c===d?1:0,f=c;f--;){var g=a.charCodeAt(f%c),h=b.charCodeAt(f%d),i=g===h;e&=i}return 1===e}var c;return c=sjcl,{checkHmac:function(c,d,e){return b(a(c,d),e)},hmac:a,equal:b}});var dbits,canary=0xdeadbeefcafe,j_lm=15715070==(16777215&canary);j_lm&&"Microsoft Internet Explorer"==navigator.appName?(BigInteger.prototype.am=am2,dbits=30):j_lm&&"Netscape"!=navigator.appName?(BigInteger.prototype.am=am1,dbits=26):(BigInteger.prototype.am=am3,dbits=28),BigInteger.prototype.DB=dbits,BigInteger.prototype.DM=(1<<dbits)-1,BigInteger.prototype.DV=1<<dbits;var BI_FP=52;BigInteger.prototype.FV=Math.pow(2,BI_FP),BigInteger.prototype.F1=BI_FP-dbits,BigInteger.prototype.F2=2*dbits-BI_FP;var BI_RM="0123456789abcdefghijklmnopqrstuvwxyz",BI_RC=new Array,rr,vv;for(rr="0".charCodeAt(0),vv=0;9>=vv;++vv)BI_RC[rr++]=vv;for(rr="a".charCodeAt(0),vv=10;36>vv;++vv)BI_RC[rr++]=vv;for(rr="A".charCodeAt(0),vv=10;36>vv;++vv)BI_RC[rr++]=vv;Classic.prototype.convert=cConvert,Classic.prototype.revert=cRevert,Classic.prototype.reduce=cReduce,Classic.prototype.mulTo=cMulTo,Classic.prototype.sqrTo=cSqrTo,Montgomery.prototype.convert=montConvert,Montgomery.prototype.revert=montRevert,Montgomery.prototype.reduce=montReduce,Montgomery.prototype.mulTo=montMulTo,Montgomery.prototype.sqrTo=montSqrTo,BigInteger.prototype.copyTo=bnpCopyTo,BigInteger.prototype.fromInt=bnpFromInt,BigInteger.prototype.fromString=bnpFromString,BigInteger.prototype.clamp=bnpClamp,BigInteger.prototype.dlShiftTo=bnpDLShiftTo,BigInteger.prototype.drShiftTo=bnpDRShiftTo,BigInteger.prototype.lShiftTo=bnpLShiftTo,BigInteger.prototype.rShiftTo=bnpRShiftTo,BigInteger.prototype.subTo=bnpSubTo,BigInteger.prototype.multiplyTo=bnpMultiplyTo,BigInteger.prototype.squareTo=bnpSquareTo,BigInteger.prototype.divRemTo=bnpDivRemTo,BigInteger.prototype.invDigit=bnpInvDigit,BigInteger.prototype.isEven=bnpIsEven,BigInteger.prototype.exp=bnpExp,BigInteger.prototype.toString=bnToString,BigInteger.prototype.negate=bnNegate,BigInteger.prototype.abs=bnAbs,BigInteger.prototype.compareTo=bnCompareTo,BigInteger.prototype.bitLength=bnBitLength,BigInteger.prototype.mod=bnMod,BigInteger.prototype.modPowInt=bnModPowInt,BigInteger.ZERO=nbv(0),BigInteger.ONE=nbv(1),NullExp.prototype.convert=nNop,NullExp.prototype.revert=nNop,NullExp.prototype.mulTo=nMulTo,NullExp.prototype.sqrTo=nSqrTo,Barrett.prototype.convert=barrettConvert,Barrett.prototype.revert=barrettRevert,Barrett.prototype.reduce=barrettReduce,Barrett.prototype.mulTo=barrettMulTo,Barrett.prototype.sqrTo=barrettSqrTo;var lowprimes=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509],lplim=(1<<26)/lowprimes[lowprimes.length-1];BigInteger.prototype.chunkSize=bnpChunkSize,BigInteger.prototype.toRadix=bnpToRadix,BigInteger.prototype.fromRadix=bnpFromRadix,BigInteger.prototype.fromNumber=bnpFromNumber,BigInteger.prototype.bitwiseTo=bnpBitwiseTo,BigInteger.prototype.changeBit=bnpChangeBit,BigInteger.prototype.addTo=bnpAddTo,BigInteger.prototype.dMultiply=bnpDMultiply,BigInteger.prototype.dAddOffset=bnpDAddOffset,BigInteger.prototype.multiplyLowerTo=bnpMultiplyLowerTo,BigInteger.prototype.multiplyUpperTo=bnpMultiplyUpperTo,BigInteger.prototype.modInt=bnpModInt,BigInteger.prototype.millerRabin=bnpMillerRabin,BigInteger.prototype.clone=bnClone,BigInteger.prototype.intValue=bnIntValue,BigInteger.prototype.byteValue=bnByteValue,BigInteger.prototype.shortValue=bnShortValue,BigInteger.prototype.signum=bnSigNum,BigInteger.prototype.toByteArray=bnToByteArray,BigInteger.prototype.equals=bnEquals,BigInteger.prototype.min=bnMin,BigInteger.prototype.max=bnMax,BigInteger.prototype.and=bnAnd,BigInteger.prototype.or=bnOr,BigInteger.prototype.xor=bnXor,BigInteger.prototype.andNot=bnAndNot,BigInteger.prototype.not=bnNot,BigInteger.prototype.shiftLeft=bnShiftLeft,BigInteger.prototype.shiftRight=bnShiftRight,BigInteger.prototype.getLowestSetBit=bnGetLowestSetBit,BigInteger.prototype.bitCount=bnBitCount,BigInteger.prototype.testBit=bnTestBit,BigInteger.prototype.setBit=bnSetBit,BigInteger.prototype.clearBit=bnClearBit,BigInteger.prototype.flipBit=bnFlipBit,BigInteger.prototype.add=bnAdd,BigInteger.prototype.subtract=bnSubtract,BigInteger.prototype.multiply=bnMultiply,BigInteger.prototype.divide=bnDivide,BigInteger.prototype.remainder=bnRemainder,BigInteger.prototype.divideAndRemainder=bnDivideAndRemainder,BigInteger.prototype.modPow=bnModPow,BigInteger.prototype.modInverse=bnModInverse,BigInteger.prototype.pow=bnPow,BigInteger.prototype.gcd=bnGCD,BigInteger.prototype.isProbablePrime=bnIsProbablePrime;var BigInt=BigInteger;BigInt.TWO=new BigInt("2",10),BigInt.setup=function(a){a()},BigInt.prototype.toJSONObject=function(){return this.toString()},BigInt.fromJSONObject=function(a){return new BigInt(a,10)},BigInt.fromInt=function(a){return BigInt.fromJSONObject(""+a)},BigInt.use_applet=!1,function(){var a=!1,b=/xyz/.test(function(){})?/\b_super\b/:/.*/;this.Class=function(){},Class.extend=function(c){function d(){!a&&this.init&&this.init.apply(this,arguments)}var e=this.prototype;a=!0;var f=new this;a=!1;for(var g in c)f[g]="function"==typeof c[g]&&"function"==typeof e[g]&&b.test(c[g])?function(a,b){return function(){var c=this._super;this._super=e[a];var d=b.apply(this,arguments);return this._super=c,d}}(g,c[g]):c[g];return d.prototype=f,d.constructor=d,d.extend=arguments.callee,d}}(),ElGamal={},ElGamal.Params=Class.extend({init:function(a,b,c){this.p=a,this.q=b,this.g=c
},generate:function(){var a=Random.getRandomInteger(this.q),b=this.g.modPow(a,this.p),c=new ElGamal.PublicKey(this.p,this.q,this.g,b),d=new ElGamal.SecretKey(a,c);return d},toJSONObject:function(){return{g:this.g.toJSONObject(),p:this.p.toJSONObject(),q:this.q.toJSONObject()}}}),ElGamal.Params.fromJSONObject=function(a){var b=new ElGamal.Params;return b.p=BigInt.fromJSONObject(a.p),b.q=BigInt.fromJSONObject(a.q),b.g=BigInt.fromJSONObject(a.g),b},ElGamal.PublicKey=Class.extend({init:function(a,b,c,d){this.p=a,this.q=b,this.g=c,this.y=d},toJSONObject:function(){return{g:this.g.toJSONObject(),p:this.p.toJSONObject(),q:this.q.toJSONObject(),y:this.y.toJSONObject()}},verifyKnowledgeOfSecretKey:function(a,b){if(null!=b&&!a.challenge.equals(b(a.commitment)))return!1;var c=this.g.modPow(a.response,this.p).equals(this.y.modPow(a.challenge,this.p).multiply(a.commitment).mod(this.p));return c},verifyDecryptionFactor:function(a,b,c,d){return c.verify(this.g,a.alpha,this.y,b,this.p,this.q,d)},multiply:function(a){if(0==a||1==a)return this;if(!this.p.equals(a.p))throw"mismatched params";if(!this.g.equals(a.g))throw"mismatched params";var b=new ElGamal.PublicKey(this.p,this.q,this.g,this.y.multiply(a.y).mod(this.p));return b},equals:function(a){return this.p.equals(a.p)&&this.q.equals(a.q)&&this.g.equals(a.g)&&this.y.equals(a.y)}}),ElGamal.PublicKey.fromJSONObject=function(a){var b=new ElGamal.PublicKey;return b.p=BigInt.fromJSONObject(a.p),b.q=BigInt.fromJSONObject(a.q),b.g=BigInt.fromJSONObject(a.g),b.y=BigInt.fromJSONObject(a.y),b},ElGamal.SecretKey=Class.extend({init:function(a,b){this.x=a,this.pk=b},toJSONObject:function(){return{public_key:this.pk.toJSONObject(),x:this.x.toJSONObject()}},decryptionFactor:function(a){var b=a.alpha.modPow(this.x,this.pk.p);return b},decrypt:function(a,b){return b||(b=this.decryptionFactor(a)),a.decrypt([b])},decryptAndProve:function(a,b){var c=this.decryptionFactorAndProof(a,b),d=this.decrypt(a,c.decryption_factor);return{plaintext:d,proof:c.decryption_proof}},decryptionFactorAndProof:function(a,b){var c=this.decryptionFactor(a),d=ElGamal.Proof.generate(this.pk.g,a.alpha,this.x,this.pk.p,this.pk.q,b);return{decryption_factor:c,decryption_proof:d}},proveKnowledge:function(a){var b=Random.getRandomInteger(this.pk.q),c=this.pk.g.modPow(b,this.pk.p),d=a(c),e=b.add(this.x.multiply(d)).mod(this.pk.q);return new ElGamal.DLogProof(c,d,e)}}),ElGamal.SecretKey.fromJSONObject=function(a){var b=new ElGamal.SecretKey;return b.pk=ElGamal.PublicKey.fromJSONObject(a.public_key),b.x=BigInt.fromJSONObject(a.x),b},ElGamal.Ciphertext=Class.extend({init:function(a,b,c){this.alpha=a,this.beta=b,this.pk=c},toString:function(){return this.alpha.toString()+","+this.beta.toString()},toJSONObject:function(){return{alpha:this.alpha.toJSONObject(),beta:this.beta.toJSONObject()}},multiply:function(a){return 1==a?this:new ElGamal.Ciphertext(this.alpha.multiply(a.alpha).mod(this.pk.p),this.beta.multiply(a.beta).mod(this.pk.p),this.pk)},decrypt:function(a){var b=this.beta,c=this;return _(a).each(function(a){b=a.modInverse(c.pk.p).multiply(b).mod(c.pk.p)}),new ElGamal.Plaintext(b,this.pk,!1)},generateProof:function(a,b,c){var d=ElGamal.Proof.generate(this.pk.g,this.pk.y,b,this.pk.p,this.pk.q,c);return d},simulateProof:function(a,b){var c=this.beta.multiply(a.m.modInverse(this.pk.p)).mod(this.pk.p);return ElGamal.Proof.simulate(this.pk.g,this.pk.y,this.alpha,c,this.pk.p,this.pk.q,b)},verifyProof:function(a,b,c){var d=this.beta.multiply(a.m.modInverse(this.pk.p)).mod(this.pk.p);return b.verify(this.pk.g,this.pk.y,this.alpha,d,this.pk.p,this.pk.q,c)},verifyPlaintextProof:function(a,b){var c=b(a.commitment);return c.equals(a.challenge)?this.pk.g.modPow(a.response,this.pk.p).equals(this.alpha.modPow(a.challenge,this.pk.p).multiply(a.commitment.a).mod(this.pk.p)):!1},verifyDecryptionProof:function(a,b,c){var d=this.beta.multiply(a.m.modInverse(this.pk.p)).mod(this.pk.p);return b.verify(this.pk.g,this.alpha,this.pk.y,d,this.pk.p,this.pk.q,c)},generateDisjunctiveProof:function(a,b,c,d){var e=this,f=_(a).map(function(a,c){return c==b?{}:e.simulateProof(a)}),g=this.generateProof(a[b],c,function(a){f[b]={commitment:a};var c=_(f).map(function(a){return a.commitment}),g=d(c),h=g;return _(f).each(function(a,c){c!=b&&(h=h.add(a.challenge.negate()))}),h.mod(e.pk.q)});return f[b]=g,new ElGamal.DisjunctiveProof(f)},verifyDisjunctiveProof:function(a,b,c){for(var d=b.proofs,e=0;e<a.length;e++)if(!this.verifyProof(a[e],d[e]))return!1;var f=_(d).map(function(a){return a.commitment}),g=c(f),h=new BigInt("0",10),i=this;return _(d).each(function(a){h=h.add(a.challenge).mod(i.pk.q)}),g.equals(h)},equals:function(a){return this.alpha.equals(a.alpha)&&this.beta.equals(a.beta)}}),ElGamal.Ciphertext.fromJSONObject=function(a,b){return new ElGamal.Ciphertext(BigInt.fromJSONObject(a.alpha),BigInt.fromJSONObject(a.beta),b)},ElGamal.Plaintext=Class.extend({init:function(a,b,c){if(null==a)return void alert("oy null m");if(this.pk=b,c){var d=a.add(BigInt.ONE),e=d.modPow(b.q,b.p);this.m=e.equals(BigInt.ONE)?d:d.negate().mod(b.p)}else this.m=a},getPlaintext:function(){var a;return a=this.m.compareTo(this.pk.q)<0?this.m:this.m.negate().mod(this.pk.p),a.subtract(BigInt.ONE)},getM:function(){return this.m},proveKnowledge:function(a,b,c){var d=Random.getRandomInteger(this.pk.q),e=this.pk.g.modPow(d,this.pk.p),f=new ElGamal.PlaintextCommitment(a,e),g=c(f),h=d.add(b.multiply(g)).mod(this.pk.q);return new ElGamal.DLogProof(f,g,h)}}),ElGamal.Proof=Class.extend({init:function(a,b,c,d){this.commitment={},this.commitment.A=a,this.commitment.B=b,this.challenge=c,this.response=d},toJSONObject:function(){return{challenge:this.challenge.toJSONObject(),commitment:{A:this.commitment.A.toJSONObject(),B:this.commitment.B.toJSONObject()},response:this.response.toJSONObject()}},verify:function(a,b,c,d,e,f,g){var h=a.modPow(this.response,e).equals(c.modPow(this.challenge,e).multiply(this.commitment.A).mod(e)),i=b.modPow(this.response,e).equals(d.modPow(this.challenge,e).multiply(this.commitment.B).mod(e)),j=!0;return g&&(j=this.challenge.equals(g(this.commitment))),h&&i&&j}}),ElGamal.Proof.fromJSONObject=function(a){return new ElGamal.Proof(BigInt.fromJSONObject(a.commitment.A),BigInt.fromJSONObject(a.commitment.B),BigInt.fromJSONObject(a.challenge),BigInt.fromJSONObject(a.response))},ElGamal.Proof.generate=function(a,b,c,d,e,f){var g=Random.getRandomInteger(e),h=new ElGamal.Proof;return h.commitment.A=a.modPow(g,d),h.commitment.B=b.modPow(g,d),h.challenge=f(h.commitment),h.response=g.add(c.multiply(h.challenge)).mod(e),h},ElGamal.Proof.simulate=function(a,b,c,d,e,f,g){null==g&&(g=Random.getRandomInteger(f));var h=Random.getRandomInteger(f),i=c.modPow(g,e).modInverse(e).multiply(a.modPow(h,e)).mod(e),j=d.modPow(g,e).modInverse(e).multiply(b.modPow(h,e)).mod(e);return new ElGamal.Proof(i,j,g,h)},ElGamal.DisjunctiveProof=Class.extend({init:function(a){this.proofs=a},toJSONObject:function(){return _(this.proofs).map(function(a){return a.toJSONObject()})}}),ElGamal.DisjunctiveProof.fromJSONObject=function(a){return null==a?null:new ElGamal.DisjunctiveProof(_(a).map(function(a){return ElGamal.Proof.fromJSONObject(a)}))},ElGamal.encrypt=function(a,b,c){if(b.getM().equals(BigInt.ZERO))throw"Can't encrypt 0 with El Gamal";c||(c=Random.getRandomInteger(a.q));var d=a.g.modPow(c,a.p),e=a.y.modPow(c,a.p).multiply(b.m).mod(a.p);return new ElGamal.Ciphertext(d,e,a)},ElGamal.DLogProof=Class.extend({init:function(a,b,c){this.commitment=a,this.challenge=b,this.response=c},toJSONObject:function(){return{challenge:this.challenge.toJSONObject(),commitment:this.commitment.toJSONObject(),response:this.response.toJSONObject()}}}),ElGamal.DLogProof.fromJSONObject=function(a){return new ElGamal.DLogProof(BigInt.fromJSONObject(a.commitment||a.s),BigInt.fromJSONObject(a.challenge),BigInt.fromJSONObject(a.response))},ElGamal.PlaintextCommitment=Class.extend({init:function(a,b){this.alpha=a,this.a=b},toJSONObject:function(){return this.a.toJSONObject()},toString:function(){return this.alpha.toJSONObject()+"/"+this.a.toJSONObject()}}),ElGamal.DLogProof.fromJSONObject=function(a){return new ElGamal.DLogProof(BigInt.fromJSONObject(a.commitment||a.s),BigInt.fromJSONObject(a.challenge),BigInt.fromJSONObject(a.response))},ElGamal.disjunctive_challenge_generator=function(a){var b=[];return _(a).each(function(a){b[b.length]=a.A.toJSONObject(),b[b.length]=a.B.toJSONObject()}),new BigInt(hex_sha1(b.join(",")),16)},ElGamal.fiatshamir_challenge_generator=function(a){return ElGamal.disjunctive_challenge_generator([a])},ElGamal.fiatshamir_dlog_challenge_generator=function(a){return new BigInt(hex_sha256(a.toString()),16)},Random={},Random.GENERATOR=null,Random.setupGenerator=function(){},Random.getRandomInteger=function(a){var b=a.bitLength();Random.setupGenerator();var c;c=sjcl.random.randomWords(b/32,0);var d=new BigInt(sjcl.codec.hex.fromBits(c),16);return d.mod(a)};var hexcase=0,b64pad="",chrsz=8,chrsz=8,hexcase=0,t=void 0,u=!1,sjcl={cipher:{},hash:{},keyexchange:{},mode:{},misc:{},codec:{},exception:{corrupt:function(a){this.toString=function(){return"CORRUPT: "+this.message},this.message=a},invalid:function(a){this.toString=function(){return"INVALID: "+this.message},this.message=a},bug:function(a){this.toString=function(){return"BUG: "+this.message},this.message=a},notReady:function(a){this.toString=function(){return"NOT READY: "+this.message},this.message=a}}};"undefined"!=typeof module&&module.exports&&(module.exports=sjcl),sjcl.cipher.aes=function(a){this.j[0][0][0]||this.D();var b,c,d,e,f=this.j[0][4],g=this.j[1];b=a.length;var h=1;for(4!==b&&6!==b&&8!==b&&q(new sjcl.exception.invalid("invalid aes key size")),this.a=[d=a.slice(0),e=[]],a=b;4*b+28>a;a++)c=d[a-1],(0===a%b||8===b&&4===a%b)&&(c=f[c>>>24]<<24^f[c>>16&255]<<16^f[c>>8&255]<<8^f[255&c],0===a%b&&(c=c<<8^c>>>24^h<<24,h=h<<1^283*(h>>7))),d[a]=d[a-b]^c;for(b=0;a;b++,a--)c=d[3&b?a:a-4],e[b]=4>=a||4>b?c:g[0][f[c>>>24]]^g[1][f[c>>16&255]]^g[2][f[c>>8&255]]^g[3][f[255&c]]},sjcl.cipher.aes.prototype={encrypt:function(a){return y(this,a,0)},decrypt:function(a){return y(this,a,1)},j:[[[],[],[],[],[]],[[],[],[],[],[]]],D:function(){var a,b,c,d,e,f,g,h=this.j[0],i=this.j[1],j=h[4],k=i[4],l=[],m=[];for(a=0;256>a;a++)m[(l[a]=a<<1^283*(a>>7))^a]=a;for(b=c=0;!j[b];b^=d||1,c=m[c]||1)for(f=c^c<<1^c<<2^c<<3^c<<4,f=f>>8^255&f^99,j[b]=f,k[f]=b,e=l[a=l[d=l[b]]],g=16843009*e^65537*a^257*d^16843008*b,e=257*l[f]^16843008*f,a=0;4>a;a++)h[a][b]=e=e<<24^e>>>8,i[a][f]=g=g<<24^g>>>8;for(a=0;5>a;a++)h[a]=h[a].slice(0),i[a]=i[a].slice(0)}},sjcl.bitArray={bitSlice:function(a,b,c){return a=sjcl.bitArray.P(a.slice(b/32),32-(31&b)).slice(1),c===t?a:sjcl.bitArray.clamp(a,c-b)},extract:function(a,b,c){var d=Math.floor(-b-c&31);return(-32&(b+c-1^b)?a[b/32|0]<<32-d^a[b/32+1|0]>>>d:a[b/32|0]>>>d)&(1<<c)-1},concat:function(a,b){if(0===a.length||0===b.length)return a.concat(b);var c=a[a.length-1],d=sjcl.bitArray.getPartial(c);return 32===d?a.concat(b):sjcl.bitArray.P(b,d,0|c,a.slice(0,a.length-1))},bitLength:function(a){var b=a.length;return 0===b?0:32*(b-1)+sjcl.bitArray.getPartial(a[b-1])},clamp:function(a,b){if(32*a.length<b)return a;a=a.slice(0,Math.ceil(b/32));var c=a.length;return b&=31,c>0&&b&&(a[c-1]=sjcl.bitArray.partial(b,a[c-1]&2147483648>>b-1,1)),a},partial:function(a,b,c){return 32===a?b:(c?0|b:b<<32-a)+1099511627776*a},getPartial:function(a){return Math.round(a/1099511627776)||32},equal:function(a,b){if(sjcl.bitArray.bitLength(a)!==sjcl.bitArray.bitLength(b))return u;var c,d=0;for(c=0;c<a.length;c++)d|=a[c]^b[c];return 0===d},P:function(a,b,c,d){var e;for(e=0,d===t&&(d=[]);b>=32;b-=32)d.push(c),c=0;if(0===b)return d.concat(a);for(e=0;e<a.length;e++)d.push(c|a[e]>>>b),c=a[e]<<32-b;return e=a.length?a[a.length-1]:0,a=sjcl.bitArray.getPartial(e),d.push(sjcl.bitArray.partial(b+a&31,b+a>32?c:d.pop(),1)),d},k:function(a,b){return[a[0]^b[0],a[1]^b[1],a[2]^b[2],a[3]^b[3]]}},sjcl.codec.utf8String={fromBits:function(a){var b,c,d="",e=sjcl.bitArray.bitLength(a);for(b=0;e/8>b;b++)0===(3&b)&&(c=a[b/4]),d+=String.fromCharCode(c>>>24),c<<=8;return decodeURIComponent(escape(d))},toBits:function(a){a=unescape(encodeURIComponent(a));var b,c=[],d=0;for(b=0;b<a.length;b++)d=d<<8|a.charCodeAt(b),3===(3&b)&&(c.push(d),d=0);return 3&b&&c.push(sjcl.bitArray.partial(8*(3&b),d)),c}},sjcl.codec.hex={fromBits:function(a){var b,c="";for(b=0;b<a.length;b++)c+=((0|a[b])+0xf00000000000).toString(16).substr(4);return c.substr(0,sjcl.bitArray.bitLength(a)/4)},toBits:function(a){var b,c,d=[];for(a=a.replace(/\s|0x/g,""),c=a.length,a+="00000000",b=0;b<a.length;b+=8)d.push(0^parseInt(a.substr(b,8),16));return sjcl.bitArray.clamp(d,4*c)}},sjcl.codec.base64={J:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",fromBits:function(a,b,c){var d="",e=0,f=sjcl.codec.base64.J,g=0,h=sjcl.bitArray.bitLength(a);for(c&&(f=f.substr(0,62)+"-_"),c=0;6*d.length<h;)d+=f.charAt((g^a[c]>>>e)>>>26),6>e?(g=a[c]<<6-e,e+=26,c++):(g<<=6,e-=6);for(;3&d.length&&!b;)d+="=";return d},toBits:function(a,b){a=a.replace(/\s|=/g,"");var c,d,e=[],f=0,g=sjcl.codec.base64.J,h=0;for(b&&(g=g.substr(0,62)+"-_"),c=0;c<a.length;c++)d=g.indexOf(a.charAt(c)),0>d&&q(new sjcl.exception.invalid("this isn't base64!")),f>26?(f-=26,e.push(h^d>>>f),h=d<<32-f):(f+=6,h^=d<<32-f);return 56&f&&e.push(sjcl.bitArray.partial(56&f,h,1)),e}},sjcl.codec.base64url={fromBits:function(a){return sjcl.codec.base64.fromBits(a,1,1)},toBits:function(a){return sjcl.codec.base64.toBits(a,1)}},sjcl.hash.sha256=function(a){this.a[0]||this.D(),a?(this.q=a.q.slice(0),this.n=a.n.slice(0),this.g=a.g):this.reset()},sjcl.hash.sha256.hash=function(a){return(new sjcl.hash.sha256).update(a).finalize()},sjcl.hash.sha256.prototype={blockSize:512,reset:function(){return this.q=this.N.slice(0),this.n=[],this.g=0,this},update:function(a){"string"==typeof a&&(a=sjcl.codec.utf8String.toBits(a));var b,c=this.n=sjcl.bitArray.concat(this.n,a);for(b=this.g,a=this.g=b+sjcl.bitArray.bitLength(a),b=512+b&-512;a>=b;b+=512)z(this,c.splice(0,16));return this},finalize:function(){var a,b=this.n,c=this.q,b=sjcl.bitArray.concat(b,[sjcl.bitArray.partial(1,1)]);for(a=b.length+2;15&a;a++)b.push(0);for(b.push(Math.floor(this.g/4294967296)),b.push(0|this.g);b.length;)z(this,b.splice(0,16));return this.reset(),c},N:[],a:[],D:function(){function a(a){return 4294967296*(a-Math.floor(a))|0}var b,c=0,d=2;a:for(;64>c;d++){for(b=2;d>=b*b;b++)if(0===d%b)continue a;8>c&&(this.N[c]=a(Math.pow(d,.5))),this.a[c]=a(Math.pow(d,1/3)),c++}}},sjcl.mode.ccm={name:"ccm",encrypt:function(a,b,c,d,e){var f,g=b.slice(0),h=sjcl.bitArray,i=h.bitLength(c)/8,j=h.bitLength(g)/8;for(e=e||64,d=d||[],7>i&&q(new sjcl.exception.invalid("ccm: iv must be at least 7 bytes")),f=2;4>f&&j>>>8*f;f++);return 15-i>f&&(f=15-i),c=h.clamp(c,8*(15-f)),b=sjcl.mode.ccm.L(a,b,c,d,e,f),g=sjcl.mode.ccm.o(a,g,c,b,e,f),h.concat(g.data,g.tag)},decrypt:function(a,b,c,d,e){e=e||64,d=d||[];var f=sjcl.bitArray,g=f.bitLength(c)/8,h=f.bitLength(b),i=f.clamp(b,h-e),j=f.bitSlice(b,h-e),h=(h-e)/8;for(7>g&&q(new sjcl.exception.invalid("ccm: iv must be at least 7 bytes")),b=2;4>b&&h>>>8*b;b++);return 15-g>b&&(b=15-g),c=f.clamp(c,8*(15-b)),i=sjcl.mode.ccm.o(a,i,c,j,e,b),a=sjcl.mode.ccm.L(a,i.data,c,d,e,b),f.equal(i.tag,a)||q(new sjcl.exception.corrupt("ccm: tag doesn't match")),i.data},L:function(a,b,c,d,e,f){var g=[],h=sjcl.bitArray,i=h.k;if(e/=8,(e%2||4>e||e>16)&&q(new sjcl.exception.invalid("ccm: invalid tag length")),(4294967295<d.length||4294967295<b.length)&&q(new sjcl.exception.bug("ccm: can't deal with 4GiB or more data")),f=[h.partial(8,(d.length?64:0)|e-2<<2|f-1)],f=h.concat(f,c),f[3]|=h.bitLength(b)/8,f=a.encrypt(f),d.length)for(c=h.bitLength(d)/8,65279>=c?g=[h.partial(16,c)]:4294967295>=c&&(g=h.concat([h.partial(16,65534)],[c])),g=h.concat(g,d),d=0;d<g.length;d+=4)f=a.encrypt(i(f,g.slice(d,d+4).concat([0,0,0])));for(d=0;d<b.length;d+=4)f=a.encrypt(i(f,b.slice(d,d+4).concat([0,0,0])));return h.clamp(f,8*e)},o:function(a,b,c,d,e,f){var g,h=sjcl.bitArray;g=h.k;var i=b.length,j=h.bitLength(b);if(c=h.concat([h.partial(8,f-1)],c).concat([0,0,0]).slice(0,4),d=h.bitSlice(g(d,a.encrypt(c)),0,e),!i)return{tag:d,data:[]};for(g=0;i>g;g+=4)c[3]++,e=a.encrypt(c),b[g]^=e[0],b[g+1]^=e[1],b[g+2]^=e[2],b[g+3]^=e[3];return{tag:d,data:h.clamp(b,j)}}},sjcl.mode.ocb2={name:"ocb2",encrypt:function(a,b,c,d,e,f){128!==sjcl.bitArray.bitLength(c)&&q(new sjcl.exception.invalid("ocb iv must be 128 bits"));var g,h=sjcl.mode.ocb2.H,i=sjcl.bitArray,j=i.k,k=[0,0,0,0];c=h(a.encrypt(c));var l,m=[];for(d=d||[],e=e||64,g=0;g+4<b.length;g+=4)l=b.slice(g,g+4),k=j(k,l),m=m.concat(j(c,a.encrypt(j(c,l)))),c=h(c);return l=b.slice(g),b=i.bitLength(l),g=a.encrypt(j(c,[0,0,0,b])),l=i.clamp(j(l.concat([0,0,0]),g),b),k=j(k,j(l.concat([0,0,0]),g)),k=a.encrypt(j(k,j(c,h(c)))),d.length&&(k=j(k,f?d:sjcl.mode.ocb2.pmac(a,d))),m.concat(i.concat(l,i.clamp(k,e)))},decrypt:function(a,b,c,d,e,f){128!==sjcl.bitArray.bitLength(c)&&q(new sjcl.exception.invalid("ocb iv must be 128 bits")),e=e||64;var g,h,i=sjcl.mode.ocb2.H,j=sjcl.bitArray,k=j.k,l=[0,0,0,0],m=i(a.encrypt(c)),n=sjcl.bitArray.bitLength(b)-e,o=[];for(d=d||[],c=0;n/32>c+4;c+=4)g=k(m,a.decrypt(k(m,b.slice(c,c+4)))),l=k(l,g),o=o.concat(g),m=i(m);return h=n-32*c,g=a.encrypt(k(m,[0,0,0,h])),g=k(g,j.clamp(b.slice(c),h).concat([0,0,0])),l=k(l,g),l=a.encrypt(k(l,k(m,i(m)))),d.length&&(l=k(l,f?d:sjcl.mode.ocb2.pmac(a,d))),j.equal(j.clamp(l,e),j.bitSlice(b,n))||q(new sjcl.exception.corrupt("ocb: tag doesn't match")),o.concat(j.clamp(g,h))},pmac:function(a,b){var c,d=sjcl.mode.ocb2.H,e=sjcl.bitArray,f=e.k,g=[0,0,0,0],h=a.encrypt([0,0,0,0]),h=f(h,d(d(h)));for(c=0;c+4<b.length;c+=4)h=d(h),g=f(g,a.encrypt(f(h,b.slice(c,c+4))));return c=b.slice(c),128>e.bitLength(c)&&(h=f(h,d(h)),c=e.concat(c,[-2147483648,0,0,0])),g=f(g,c),a.encrypt(f(d(f(h,d(h))),g))},H:function(a){return[a[0]<<1^a[1]>>>31,a[1]<<1^a[2]>>>31,a[2]<<1^a[3]>>>31,a[3]<<1^135*(a[0]>>>31)]}},sjcl.mode.gcm={name:"gcm",encrypt:function(a,b,c,d,e){var f=b.slice(0);return b=sjcl.bitArray,d=d||[],a=sjcl.mode.gcm.o(!0,a,f,d,c,e||128),b.concat(a.data,a.tag)},decrypt:function(a,b,c,d,e){var f=b.slice(0),g=sjcl.bitArray,h=g.bitLength(f);return e=e||128,d=d||[],h>=e?(b=g.bitSlice(f,h-e),f=g.bitSlice(f,0,h-e)):(b=f,f=[]),a=sjcl.mode.gcm.o(u,a,f,d,c,e),g.equal(a.tag,b)||q(new sjcl.exception.corrupt("gcm: tag doesn't match")),a.data},W:function(a,b){var c,d,e,f,g,h=sjcl.bitArray.k;for(e=[0,0,0,0],f=b.slice(0),c=0;128>c;c++){for((d=0!==(a[Math.floor(c/32)]&1<<31-c%32))&&(e=h(e,f)),g=0!==(1&f[3]),d=3;d>0;d--)f[d]=f[d]>>>1|(1&f[d-1])<<31;f[0]>>>=1,g&&(f[0]^=-520093696)}return e},f:function(a,b,c){var d,e=c.length;for(b=b.slice(0),d=0;e>d;d+=4)b[0]^=4294967295&c[d],b[1]^=4294967295&c[d+1],b[2]^=4294967295&c[d+2],b[3]^=4294967295&c[d+3],b=sjcl.mode.gcm.W(b,a);return b},o:function(a,b,c,d,e,f){var g,h,i,j,k,l,m,n,o=sjcl.bitArray;for(l=c.length,m=o.bitLength(c),n=o.bitLength(d),h=o.bitLength(e),g=b.encrypt([0,0,0,0]),96===h?(e=e.slice(0),e=o.concat(e,[1])):(e=sjcl.mode.gcm.f(g,[0,0,0,0],e),e=sjcl.mode.gcm.f(g,e,[0,0,Math.floor(h/4294967296),4294967295&h])),h=sjcl.mode.gcm.f(g,[0,0,0,0],d),k=e.slice(0),d=h.slice(0),a||(d=sjcl.mode.gcm.f(g,h,c)),j=0;l>j;j+=4)k[3]++,i=b.encrypt(k),c[j]^=i[0],c[j+1]^=i[1],c[j+2]^=i[2],c[j+3]^=i[3];return c=o.clamp(c,m),a&&(d=sjcl.mode.gcm.f(g,h,c)),a=[Math.floor(n/4294967296),4294967295&n,Math.floor(m/4294967296),4294967295&m],d=sjcl.mode.gcm.f(g,d,a),i=b.encrypt(e),d[0]^=i[0],d[1]^=i[1],d[2]^=i[2],d[3]^=i[3],{tag:o.bitSlice(d,0,f),data:c}}},sjcl.misc.hmac=function(a,b){this.M=b=b||sjcl.hash.sha256;var c,d=[[],[]],e=b.prototype.blockSize/32;for(this.m=[new b,new b],a.length>e&&(a=b.hash(a)),c=0;e>c;c++)d[0][c]=909522486^a[c],d[1][c]=1549556828^a[c];this.m[0].update(d[0]),this.m[1].update(d[1]),this.G=new b(this.m[0])},sjcl.misc.hmac.prototype.encrypt=sjcl.misc.hmac.prototype.mac=function(a){return this.Q&&q(new sjcl.exception.invalid("encrypt on already updated hmac called!")),this.update(a),this.digest(a)},sjcl.misc.hmac.prototype.reset=function(){this.G=new this.M(this.m[0]),this.Q=u},sjcl.misc.hmac.prototype.update=function(a){this.Q=!0,this.G.update(a)},sjcl.misc.hmac.prototype.digest=function(){var a=this.G.finalize(),a=new this.M(this.m[1]).update(a).finalize();return this.reset(),a},sjcl.misc.pbkdf2=function(a,b,c,d,e){c=c||1e3,(0>d||0>c)&&q(sjcl.exception.invalid("invalid params to pbkdf2")),"string"==typeof a&&(a=sjcl.codec.utf8String.toBits(a)),"string"==typeof b&&(b=sjcl.codec.utf8String.toBits(b)),e=e||sjcl.misc.hmac,a=new e(a);var f,g,h,i,j=[],k=sjcl.bitArray;for(i=1;32*j.length<(d||1);i++){for(e=f=a.encrypt(k.concat(b,[i])),g=1;c>g;g++)for(f=a.encrypt(f),h=0;h<f.length;h++)e[h]^=f[h];j=j.concat(e)}return d&&(j=k.clamp(j,d)),j},sjcl.prng=function(a){this.b=[new sjcl.hash.sha256],this.h=[0],this.F=0,this.t={},this.C=0,this.K={},this.O=this.c=this.i=this.V=0,this.a=[0,0,0,0,0,0,0,0],this.e=[0,0,0,0],this.A=t,this.B=a,this.p=u,this.z={progress:{},seeded:{}},this.l=this.U=0,this.u=1,this.w=2,this.S=65536,this.I=[0,48,64,96,128,192,256,384,512,768,1024],this.T=3e4,this.R=80},sjcl.prng.prototype={randomWords:function(a,b){var c,d=[];c=this.isReady(b);var e;if(c===this.l&&q(new sjcl.exception.notReady("generator isn't seeded")),c&this.w){c=!(c&this.u),e=[];var f,g=0;for(this.O=e[0]=(new Date).valueOf()+this.T,f=0;16>f;f++)e.push(4294967296*Math.random()|0);for(f=0;f<this.b.length&&(e=e.concat(this.b[f].finalize()),g+=this.h[f],this.h[f]=0,!(!c&&this.F&1<<f));f++);for(this.F>=1<<this.b.length&&(this.b.push(new sjcl.hash.sha256),this.h.push(0)),this.c-=g,g>this.i&&(this.i=g),this.F++,this.a=sjcl.hash.sha256.hash(this.a.concat(e)),this.A=new sjcl.cipher.aes(this.a),c=0;4>c&&(this.e[c]=this.e[c]+1|0,!this.e[c]);c++);}for(c=0;a>c;c+=4)0===(c+1)%this.S&&A(this),e=B(this),d.push(e[0],e[1],e[2],e[3]);return A(this),d.slice(0,a)},setDefaultParanoia:function(a){this.B=a},addEntropy:function(a,b,c){c=c||"user";var d,e,f=(new Date).valueOf(),g=this.t[c],h=this.isReady(),i=0;switch(d=this.K[c],d===t&&(d=this.K[c]=this.V++),g===t&&(g=this.t[c]=0),this.t[c]=(this.t[c]+1)%this.b.length,typeof a){case"number":b===t&&(b=1),this.b[g].update([d,this.C++,1,b,f,1,0|a]);break;case"object":if(c=Object.prototype.toString.call(a),"[object Uint32Array]"===c){for(e=[],c=0;c<a.length;c++)e.push(a[c]);a=e}else for("[object Array]"!==c&&(i=1),c=0;c<a.length&&!i;c++)"number"!=typeof a[c]&&(i=1);if(!i){if(b===t)for(c=b=0;c<a.length;c++)for(e=a[c];e>0;)b++,e>>>=1;this.b[g].update([d,this.C++,2,b,f,a.length].concat(a))}break;case"string":b===t&&(b=a.length),this.b[g].update([d,this.C++,3,b,f,a.length]),this.b[g].update(a);break;default:i=1}i&&q(new sjcl.exception.bug("random: addEntropy only supports number, array of numbers or string")),this.h[g]+=b,this.c+=b,h===this.l&&(this.isReady()!==this.l&&C("seeded",Math.max(this.i,this.c)),C("progress",this.getProgress()))},isReady:function(a){return a=this.I[a!==t?a:this.B],this.i&&this.i>=a?this.h[0]>this.R&&(new Date).valueOf()>this.O?this.w|this.u:this.u:this.c>=a?this.w|this.l:this.l},getProgress:function(a){return a=this.I[a?a:this.B],this.i>=a?1:this.c>a?1:this.c/a},startCollectors:function(){this.p||(window.addEventListener?(window.addEventListener("load",this.r,u),window.addEventListener("mousemove",this.s,u)):document.attachEvent?(document.attachEvent("onload",this.r),document.attachEvent("onmousemove",this.s)):q(new sjcl.exception.bug("can't attach event")),this.p=!0)},stopCollectors:function(){this.p&&(window.removeEventListener?(window.removeEventListener("load",this.r,u),window.removeEventListener("mousemove",this.s,u)):window.detachEvent&&(window.detachEvent("onload",this.r),window.detachEvent("onmousemove",this.s)),this.p=u)},addEventListener:function(a,b){this.z[a][this.U++]=b},removeEventListener:function(a,b){var c,d,e=this.z[a],f=[];for(d in e)e.hasOwnProperty(d)&&e[d]===b&&f.push(d);for(c=0;c<f.length;c++)d=f[c],delete e[d]},s:function(a){sjcl.random.addEntropy([a.x||a.clientX||a.offsetX||0,a.y||a.clientY||a.offsetY||0],2,"mouse")},r:function(){sjcl.random.addEntropy((new Date).valueOf(),2,"loadtime")}},sjcl.random=new sjcl.prng(6);try{if("undefined"!=typeof module&&module.exports){var D=require("crypto").randomBytes(128);sjcl.random.addEntropy(D,1024,"crypto['randomBytes']")}else if(window&&window.crypto&&window.crypto.getRandomValues){var E=new Uint32Array(32);window.crypto.getRandomValues(E),sjcl.random.addEntropy(E,1024,"crypto['getRandomValues']")}}catch(F){}sjcl.json={defaults:{v:1,iter:1e3,ks:128,ts:64,mode:"ccm",adata:"",cipher:"aes"},encrypt:function(a,b,c,d){c=c||{},d=d||{};var e,f=sjcl.json,g=f.d({iv:sjcl.random.randomWords(4,0)},f.defaults);return f.d(g,c),c=g.adata,"string"==typeof g.salt&&(g.salt=sjcl.codec.base64.toBits(g.salt)),"string"==typeof g.iv&&(g.iv=sjcl.codec.base64.toBits(g.iv)),(!sjcl.mode[g.mode]||!sjcl.cipher[g.cipher]||"string"==typeof a&&100>=g.iter||64!==g.ts&&96!==g.ts&&128!==g.ts||128!==g.ks&&192!==g.ks&&256!==g.ks||2>g.iv.length||4<g.iv.length)&&q(new sjcl.exception.invalid("json encrypt: invalid parameters")),"string"==typeof a?(e=sjcl.misc.cachedPbkdf2(a,g),a=e.key.slice(0,g.ks/32),g.salt=e.salt):sjcl.ecc&&a instanceof sjcl.ecc.elGamal.publicKey&&(e=a.kem(),g.kemtag=e.tag,a=e.key.slice(0,g.ks/32)),"string"==typeof b&&(b=sjcl.codec.utf8String.toBits(b)),"string"==typeof c&&(c=sjcl.codec.utf8String.toBits(c)),e=new sjcl.cipher[g.cipher](a),f.d(d,g),d.key=a,g.ct=sjcl.mode[g.mode].encrypt(e,b,g.iv,c,g.ts),f.encode(g)},decrypt:function(a,b,c,d){c=c||{},d=d||{};var e=sjcl.json;b=e.d(e.d(e.d({},e.defaults),e.decode(b)),c,!0);var f;return c=b.adata,"string"==typeof b.salt&&(b.salt=sjcl.codec.base64.toBits(b.salt)),"string"==typeof b.iv&&(b.iv=sjcl.codec.base64.toBits(b.iv)),(!sjcl.mode[b.mode]||!sjcl.cipher[b.cipher]||"string"==typeof a&&100>=b.iter||64!==b.ts&&96!==b.ts&&128!==b.ts||128!==b.ks&&192!==b.ks&&256!==b.ks||!b.iv||2>b.iv.length||4<b.iv.length)&&q(new sjcl.exception.invalid("json decrypt: invalid parameters")),"string"==typeof a?(f=sjcl.misc.cachedPbkdf2(a,b),a=f.key.slice(0,b.ks/32),b.salt=f.salt):sjcl.ecc&&a instanceof sjcl.ecc.elGamal.secretKey&&(a=a.unkem(sjcl.codec.base64.toBits(b.kemtag)).slice(0,b.ks/32)),"string"==typeof c&&(c=sjcl.codec.utf8String.toBits(c)),f=new sjcl.cipher[b.cipher](a),c=sjcl.mode[b.mode].decrypt(f,b.ct,b.iv,c,b.ts),e.d(d,b),d.key=a,sjcl.codec.utf8String.fromBits(c)},encode:function(a){var b,c="{",d="";for(b in a)if(a.hasOwnProperty(b))switch(b.match(/^[a-z0-9]+$/i)||q(new sjcl.exception.invalid("json encode: invalid property name")),c+=d+'"'+b+'":',d=",",typeof a[b]){case"number":case"boolean":c+=a[b];break;case"string":c+='"'+escape(a[b])+'"';break;case"object":c+='"'+sjcl.codec.base64.fromBits(a[b],0)+'"';break;default:q(new sjcl.exception.bug("json encode: unsupported type"))}return c+"}"},decode:function(a){a=a.replace(/\s/g,""),a.match(/^\{.*\}$/)||q(new sjcl.exception.invalid("json decode: this isn't json!")),a=a.replace(/^\{|\}$/g,"").split(/,/);var b,c,d={};for(b=0;b<a.length;b++)(c=a[b].match(/^(?:(["']?)([a-z][a-z0-9]*)\1):(?:(\d+)|"([a-z0-9+\/%*_.@=\-]*)")$/i))||q(new sjcl.exception.invalid("json decode: this isn't json!")),d[c[2]]=c[3]?parseInt(c[3],10):c[2].match(/^(ct|salt|iv)$/)?sjcl.codec.base64.toBits(c[4]):unescape(c[4]);return d},d:function(a,b,c){if(a===t&&(a={}),b===t)return a;for(var d in b)b.hasOwnProperty(d)&&(c&&a[d]!==t&&a[d]!==b[d]&&q(new sjcl.exception.invalid("required parameter overridden")),a[d]=b[d]);return a},Z:function(a,b){var c,d={};for(c in a)a.hasOwnProperty(c)&&a[c]!==b[c]&&(d[c]=a[c]);return d},Y:function(a,b){var c,d={};for(c=0;c<b.length;c++)a[b[c]]!==t&&(d[b[c]]=a[b[c]]);return d}},sjcl.encrypt=sjcl.json.encrypt,sjcl.decrypt=sjcl.json.decrypt,sjcl.misc.X={},sjcl.misc.cachedPbkdf2=function(a,b){var c,d=sjcl.misc.X;return b=b||{},c=b.iter||1e3,d=d[a]=d[a]||{},c=d[c]=d[c]||{firstSalt:b.salt&&b.salt.length?b.salt.slice(0):sjcl.random.randomWords(2,0)},d=b.salt===t?c.firstSalt:b.salt,c[d]=c[d]||sjcl.misc.pbkdf2(a,d,b.iter),{key:c[d].slice(0),salt:d.slice(0)}},angular.module("agora-core-view",["ui.bootstrap","ui.utils","ui.router","jm.i18next","ngAnimate","angularMoment","home","avConfig","avBooth","avTest","avCrypto"]),angular.module("jm.i18next").config(["$i18nextProvider",function(a){a.options={useCookie:!1,useLocalStorage:!0,fallbackLng:"en",resGetPath:"/locales/__lng__.json",defaultLoadingValue:""}}]),angular.module("agora-core-view").config(["$stateProvider","$urlRouterProvider","$httpProvider",function(a){a.state("home",{url:"/election/:id/vote/:hmac/:message",templateUrl:"avBooth/booth.html",controller:"BoothController"}),a.state("test-hmac",{url:"/test_hmac/:key/:hmac/:message",templateUrl:"test/test_hmac.html",controller:"TestHmacController"})}]),angular.module("agora-core-view").run(["$rootScope",function(a){a.safeApply=function(b){var c=a.$$phase;"$apply"===c||"$digest"===c?b&&"function"==typeof b&&b():this.$apply(b)}}]),angular.module("home",["ui.bootstrap","ui.utils","ui.router","ngAnimate"]),angular.module("home").config(["$stateProvider",function(){}]),angular.module("home").controller("HomeController",["$scope","$http","$state","$log",function(a,b,c,d){a.submit=function(e){b({url:"https://agora.wadobo.dev:1000/api/v1/user/login/",method:"POST",data:{identification:a.identification,password:a.password}}).success(function(b,e){c.go("panel"),"200"===e||(a.messages="Oops, we received your request, but there was an error "+e,d.error(b))}).error(function(b,c){a.messages="There was a network error. "+c,d.error(b)}),a.submitted=!0,e.$invalid}}]),angular.module("panel",["ui.bootstrap","ui.utils","ui.router","ngAnimate"]),angular.module("panel").config(["$stateProvider",function(){}]),angular.module("panel",["ngResource"]).factory("OpenElectionsService",["$resource",function(a){return a("https://agora.wadobo.dev:1000/api/v1/agora/1/open_elections/",{},{query:{method:"GET",isArray:!1}})}]).controller("PanelController",["OpenElectionsService","$scope",function(a,b){b.elections=a.query()}]),angular.module("election",["ui.bootstrap","ui.utils","ui.router","ngAnimate"]),angular.module("election").config(["$stateProvider",function(){}]),angular.module("election",["ngResource"]).factory("ElectionService",["$resource",function(a){return a("https://agora.wadobo.dev:1000/api/v1/election/:electionId/ ",{},{query:{method:"GET"}})}]).controller("ElectionController",["ElectionService","$scope","$stateParams","$http","$log",function(a,b,c,d,e){b.id=c.id,a.query({electionId:b.id}).$promise.then(function(a){b.election=a,"ONE_CHOICE"===b.election.election_type?b.inputtype="radio":"MULTIPLE_CHOICE"===b.election.election_type&&(b.inputtype="checkbox")}),b.formData={is_vote_secret:!1,action:"vote"},b.submit=function(){d({url:"https://agora.wadobo.dev:1000/api/v1/election/"+b.id+"/action/",method:"POST",withCredentials:!0,data:b.formData}).success(function(a,c){"200"===c||(b.messages="Oops, we received your request, but there was an error "+c,e.error(a))}).error(function(a,c){b.messages="There was a network error. "+c,e.error(a)})}}]).directive("electionType",function(){return{restrict:"E",template:"Election type: {{election.election_type}}"}}),angular.module("avBooth",["ui.bootstrap","ui.utils","ui.router","ngAnimate"]),angular.module("avBooth").config(["$stateProvider",function(){}]),angular.module("avBooth").controller("BoothController",["$scope","$stateParams","ConfigService",function(a,b,c){a.electionId=b.id,a.hmacHash=b.hmac,a.hmacMessage=b.message,a.baseUrl=c.baseUrl}]),angular.module("avBooth").directive("avBooth",function(){return{restrict:"E",scope:{electionUrl:"@electionUrl"},templateUrl:"avBooth/booth-directive/booth-directive.html"}}),angular.module("avTest",[]),angular.module("avTest",[]).controller("TestHmacController",["$scope","$stateParams","HmacService","amMoment",function(a,b,c){a.hmac=b.hmac,a.message=b.message,a.key=b.key,a.calculatedHmac=c.hmac(b.key,b.message),a.hmacIsValid=c.checkHmac(b.key,b.message,b.hmac);var d="<unset>",e="<unset>",f="<unset>",g="",h=b.message.split(":");
3!==h.length?g="(Invalid message, it should follow this format: voterId:electionId:timestamp)":(d=h[0],e=""+parseInt(h[1]),f=""+parseInt(h[2])),a.voterId=d,a.electionId=e,a.timestamp=f,a.timeago=moment(f,"X").fromNow(),a.messageInvalid=g}]),angular.module("agora-core-view").run(["$templateCache",function(a){"use strict";a.put("avBooth/booth-directive/booth-directive.html",'<p>booth directive working! and the election url is "{{ electionUrl }}"</p><p ng-i18next=app.name></p>'),a.put("avBooth/booth.html","<p>Esto ser una cabina de votacin con los datos:</p><ul><li>Election id: {{ electionId }}</li><li>HMAC hash: {{ hmacHash }}</li><li>HMAC message: {{ hmacMessage }}</li><li>Election API url: {{ baseUrl }}election/{{ electionId }}</li></ul><av-booth election-url={{baseUrl}}election/{{electionId}}></av-booth>"),a.put("election/election.html",'<div ng-controller=ElectionController>{{messages}}<form name=votingForm><div ng-repeat="data in election"><div ng-repeat="question in data track by $index">{{question.question}}<div ng-repeat="answer in question.answers"><label class=radio><input type={{inputtype}} name=myVote value={{answer.value}} ng-model=formData.question0>{{answer.value}}</label></div></div></div><button data-ng-click=submit(votingForm) class="btn btn-default">Continue</button></form>{{formData}}<br>Election id: {{id}}, type: {{inputtype}}<br><election-type></election-type></div>'),a.put("home/home.html",'<div data-ng-controller=HomeController><div id=messages class="alert alert-success" data-ng-show=messages data-ng-bind=messages></div><form name=loginForm novalidate role=form><div class=form-group><label for=identification>Username</label><span class="label label-danger" data-ng-show="submitted && loginForm.identification.$error.required">Required!</span> <input type=text name=identification data-ng-model=identification class=form-control required></div><div class=form-group><label for=password>Password</label><span class="label label-danger" data-ng-show="submitted && loginForm.password.$error.required">Required!</span> <input type=password name=password data-ng-model=password class=form-control required></div><button data-ng-click=submit(loginForm) class="btn btn-default">Login</button></form></div>'),a.put("panel/panel.html",'<div ng-controller=PanelController>Open elections<ol><li ng-repeat="election in elections.objects"><a ui-sref="election({ id: election.id })">{{election.pretty_name}}</a></li></ol></div>'),a.put("playground/persiana/persiana.html",'<!DOCTYPE html><html lang=en><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content=""><meta name=author content=""><title>Off Canvas Template for Bootstrap</title><link href=https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css rel=stylesheet><link href=offcanvas.css rel=stylesheet><!--[if lt IE 9]><script src="../../assets/js/ie8-responsive-file-warning.js"></script><![endif]--><script src=ie-emulation-modes-warning.js></script><!--[if lt IE 9]><script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>\n      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script><![endif]--></head><body><div class="navbar navbar-fixed-top navbar-inverse" role=navigation><div class=container><div class=navbar-header><button type=button class="navbar-toggle collapsed" data-toggle=collapse data-target=.navbar-collapse><span class=sr-only>Toggle navigation</span> <span class=icon-bar></span> <span class=icon-bar></span> <span class=icon-bar></span></button> <a class=navbar-brand href=#>Project name</a></div><div class="collapse navbar-collapse"><ul class="nav navbar-nav"><li><div class=progress style="margin-left:15px; margin-right:15px"><div class="progress-bar progress-bar-success" role=progressbar aria-valuenow=40 aria-valuemin=0 aria-valuemax=100 style="width: 40%"><span class=sr-only>40% Complete (success)</span></div></div></li><li><a href=#progress>Progress</a></li></ul></div></div></div><div class=container><div class="row row-offcanvas row-offcanvas-right"><div class="col-xs-12 col-sm-9"><div class=row><div class="col-6 col-sm-6 col-lg-4"><div class=list-group style="margin-top: 50px"><a href=# class="list-group-item active">Cras justo odio</a> <a href=# class=list-group-item>Dapibus ac facilisis in</a> <a href=# class=list-group-item>Morbi leo risus</a> <a href=# class=list-group-item>Porta ac consectetur ac</a> <a href=# class=list-group-item>Vestibulum at eros</a></div></div><div class="col-6 col-sm-6 col-lg-4"><h2>Heading</h2><p>Donec id elit non mi porta gravida at eget metus. Fusce dapibus, tellus ac cursus commodo, tortor mauris condimentum nibh, ut fermentum massa justo sit amet risus. Etiam porta sem malesuada magna mollis euismod. Donec sed odio dui.</p><p><a class="btn btn-default" href=# role=button>View details &raquo;</a></p></div><div class="col-6 col-sm-6 col-lg-4"><h2>Heading</h2><p>Donec id elit non mi porta gravida at eget metus. Fusce dapibus, tellus ac cursus commodo, tortor mauris condimentum nibh, ut fermentum massa justo sit amet risus. Etiam porta sem malesuada magna mollis euismod. Donec sed odio dui.</p><p><a class="btn btn-default" href=# role=button>View details &raquo;</a></p></div><div class="col-6 col-sm-6 col-lg-4"><h2>Heading</h2><p>Donec id elit non mi porta gravida at eget metus. Fusce dapibus, tellus ac cursus commodo, tortor mauris condimentum nibh, ut fermentum massa justo sit amet risus. Etiam porta sem malesuada magna mollis euismod. Donec sed odio dui.</p><p><a class="btn btn-default" href=# role=button>View details &raquo;</a></p></div></div></div></div></div><hr><footer><p>&copy; Company 2014</p></footer><div class="navbar navbar-fixed-top" role=navigation style="margin-top: 65px; margin-left: 15px"><button type=button class="btn btn-primary btn-lg" style=background-color:black><span class="glyphicon glyphicon-search"></span></button></div><div class="navbar navbar-fixed-bottom" role=navigation style="margin-bottom: 10px; margin-left: 15px"><button type=button class="btn btn-primary btn-lg">Next <span class="glyphicon glyphicon-chevron-right"></span></button></div><script src=https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js></script><script src=https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js></script><script src=ie10-viewport-bug-workaround.js></script><script src=offcanvas.js></script></body></html>'),a.put("test/test_hmac.html",'<div ng-if=hmacIsValid><h2>Hmac is valid!</h2><p>HmacService.hmac(key("{{key}}"), message("{{message}}"))<br>==<br>provided-hmac("{{hmac}}")</p></div><div ng-if=!hmacIsValid><h2>Hmac is NOT valid!</h2><p>HmacService.hmac(key("{{key}}"), message("{{message}}")) =<br>calculated-hmac("{{calculatedHmac}}") != provided-hmac("{{hmac}}")</p></div><h3>Data:</h3><ul><li><strong>key</strong>: "<u>{{key}}</u>"</li><li><strong>message</strong>: "<u>{{message}}</u>" {{messageInvalid}}<br><ul><li><strong>timestamp</strong> (unix timestamp, uint32): "<u>{{timestamp}}</u>" ({{timeago}})</li><li><strong>voter id</strong> (identifies the voter, string): "<u>{{voterId}}</u>"</li><li><strong>election id</strong> (election id, number): "<u>{{electionId}}</u>"</li></ul></li><li><strong>provided hmac</strong>: "<u>{{hmac}}</u>"</li><li><strong>calculated hmac</strong><span ng-if=hmacIsValid>(matches provided hmac!)</span>: "<u>{{calculatedHmac}}</u>"</li></ul>')}]);